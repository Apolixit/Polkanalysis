# Technical documentation

## Project infrastructure

Four mains blocks are represented :
- Application layer
- Domain layer
- Infrastructure layer
- Blockchain layer

## Projects
Polkanalysis provide several projects to form a coherent application and give human-friendly and business value to users

Here are details projects :
- A Blazor Web Application
    * This is the front app of the project. This front app is compatible with Substrate-base blockchains, and currently support Polkadot, Kusama and Bajun network.
    It provide functionnalities such as block details, account holders, parachain, staking and so on.
    The production version is available here : Polkanalysis.io

- A Rest API
    * The API is available for every project which want to benefit some digest and ready-to-go datas to digest blockchain storage and event.
    The API is free to use, but have some request limitation to avoid abuses and server saturation. Please check API limit rate here.

- A hosted bakground service
    * This behind the seen project is h24 live and subsribe to severals blockchain event (like new block production, data transfer event, heavy query data) and digest these data to insert it in a database. It allow the front application to have directly access to digest and structured data to display average / top X / token price data directly from structured database.

- Substrate auto generated projects
    * These projects are generated by an awesome tools, initialy developped by the Ajuna teams, and now renamed to Substrate.Net.Toolchain.
    Each project are generated from current blockchain metadata (the metadata file describe all the blockchain structure) and provide full functionnalities to interact with the blockchain.
    
## Architecture schema

![Diagram](https://github.com/Apolixit/Polkanalysis/blob/master/Docs/Archi.svg)


## In-depth projects details
The project is divided several projects, here is the details of every project and their readme file

| Blockchain Mapping      | Description | Readme |
| ----------- | ----------- | ----------- |
| Polkanalysis.API      | Rest API with digest result models to query blockchain storage and agregated data stored in database | [Readme.md](https://github.com/Apolixit/Polkanalysis/tree/master/Polkanalysis.Api/readme.md)
| Polkanalysis.Components      | [Razor component library](https://learn.microsoft.com/en-us/aspnet/core/blazor/components/class-libraries?view=aspnetcore-7.0&tabs=visual-studio) to shared front component between Blazor web app and MAUI mobile app| [Readme.md](https://github.com/Apolixit/Polkanalysis/blob/master/Polkanalysis.Components/readme.md) |
| Polkanalysis.WebApp      | [Blazor web application](https://learn.microsoft.com/en-us/aspnet/core/blazor/) | [Readme.md](https://github.com/Apolixit/Polkanalysis/blob/master/Polkanalysis.WebApp/readme.md) |
| Polkanalysis.Maui      | .NET MAUI mobile application| [Readme.md](https://github.com/Apolixit/Polkanalysis/blob/master/Polkanalysis.Maui/readme.md) |
| Polkanalysis.Web.Tests      | [Playwright .NET](https://playwright.dev/dotnet) End-to-End test project for web app | [Readme.md](https://github.com/Apolixit/Polkanalysis/blob/master/Polkanalysis.Web.Tests/readme.md) |
| Polkanalysis.Components.Tests      | [BUnit](https://bunit.dev/) component test project for Razor files | [Readme.md](https://github.com/Apolixit/Polkanalysis/blob/master/Polkanalysis.Components.Tests/readme.md) |
| Polkanalysis.Worker      | Background worker hosted application which subscribe to blockchain event, compute it, and insert in database| [Readme.md](https://github.com/Apolixit/Polkanalysis/blob/master/Polkanalysis.Domain/readme.md) |
| Polkanalysis.Domain      | The backbone of the application. every business logic is implemented here. It allow to have all software intelligence in one place | [Readme.md](https://github.com/Apolixit/Polkanalysis/blob/master/Polkanalysis.Domain.Contracts/readme.md) |
| Polkanalysis.Domain.Contracts      | Classes and interface to communicate with domain project | [Readme.md]() |
| Polkanalysis.Infrastructure.Blockchain      | Project to map [SubstrateGaming Generated projects](https://github.com/SubstrateGaming/Substrate.NET.Toolchain) as Polkadot, Kusama, Bajun substrated-based chain and map it to the Domain project | [Readme.md](https://github.com/Apolixit/Polkanalysis/blob/master/Polkanalysis.Infrastructure.Blockchain/readme.md) |
| Polkanalysis.Database      | Insert aggregated data, such as blockchain events, blockchain storage in a PostgreSQL database with [Entity Framework Core](https://learn.microsoft.com/en-us/ef/core/) | [Readme.md](https://github.com/Apolixit/Polkanalysis/tree/master/Polkanalysis.Infrastructure.Database/readme.md) |
| Polkanalysis.Database.Contract      | Classes and Interface to communicate with Polkanalysis.Database | [Readme.md](https://github.com/Apolixit/Polkanalysis/tree/master/Polkanalysis.Infrastructure.Database.Contracts/readme.md) |
| Polkanalysis.Configuration.Extension      | Read appsettings file and expose Substrate / Database / Monitoring endpoint | [Readme.md](https://github.com/Apolixit/Polkanalysis/blob/master/Polkanalysis.Configuration.Extensions/readme.md) |
| Polkanalysis.Configuration.Contracts      | Classes to represent Configuration endpoints | [Readme.md](https://github.com/Apolixit/Polkanalysis/blob/master/Polkanalysis.Configuration.Contracts/readme.md) |
## Build docker image

docker build -t polkanalysis.api -f .\api.dockerfile .  
docker build -t polkanalysis.webapp -f .\webapp.dockerfile .  
docker build -t polkanalysis.worker -f .\worker.dockerfile .  