using Blazscan.Domain.Contracts.Dto.Event;
using Blazscan.Domain.Contracts.Repository;
using Blazscan.Domain.Contracts.Runtime;
using Blazscan.SubstrateDecode.Abstract;
using Blazscan.SubstrateDecode.Event;
using NSubstitute;
namespace Blazscan.SubstrateDecode.Test.Event
{
    internal class ParaInclusionEventTest
    {

        private readonly ISubstrateDecoding _substrateDecode;

        public ParaInclusionEventTest()
        {
            //IMapping mapping, ISubstrateNodeRepository substrateRepository

            _substrateDecode = new SubstrateDecoding(new EventMapping() , Substitute.For<ISubstrateNodeRepository>(), Substitute.For<IPalletBuilder>());
        }

        [Test]
        [TestCase("0x00010000003500E903000039D33729AEFAA9EBDC83F2DD0C04AA73AD6E3CD69D56B2FD8CC8617D965CE5BB866697928238E7CB51D2049373397570C61767E8325F666BE16BFC202EB44119CEB9CB6328AA06BB70EAA962D98B27AE42C37E97D63728ED402EB10C8625C6871154F3F12AC683E515F353B02CC75F2E8A3B0F036AB8339F574EB0E18AC0A1B992139A7C81EE111175B1584C83845DD8D8CC8EF68CEE83782C489E80F28D337DB055944CD78497E14852544562D731E9990F7E73ABFA6B7FADF73FA399AD5714B6DD977A467F3984D4D9438DBBD63E671E60BE1E0477765D8BFE40236581C0897DE86D7BDCCF4F1BA5AE1A54B871FCAC2DDCD4CA0DF019BC06CC0829DE5980A46C68260EDDF3A551FA5869ED17183CB6639ADC400E63D4F60D92CA8E1A5C805AF7AC5B4ED944097BE3C1AC0138C953093500FBA5F3366F7EC62E4772FEB7F633E902C9731DFE23A4C8730A9DF334EEAF0443E696EBE15A9B977F4A81EB298CC46C70A2BD0500EACE1236FABE274FA53CF71AE0A851B7157FCC083F990667D222FA283EC1650F3AAB8AE4F9D6B2E19939E3F3B73504CF96386B4261BAB98565BC7D62B1527535080661757261209BBA4B0800000000056175726101012C2279A0AB51C3DFE60734BA33D25992E167AAF680F6274E03B1CA88A87F3244822EE78D267A7E76179096A46E656284232D1175EB521A275D57B2BED2914788010000000400000000")]
        public void ParaInclusion_CandidateBacked_ShouldBeParsed(string hex)
        {
            var nodeResult = _substrateDecode.DecodeEvent(hex);
            Assert.IsNotNull(nodeResult);
        }

        [Test]
        [TestCase("0x00010000003501E9030000F31D2AB23BD6CF4E33B141EAB8935641E51D35BF95B7A1B1A8D4336A5E08D696F440DBABAAC86F79815109D4FEE2BDDFD1F296487D004CC8A049838779BC627DD92190810ADD16D7F1F0D30A0D1C4F069B2CFD25E76E1DD29E7E26A85F753D197E472803338F6114B7261EAF206696DA03A4D58D5538A77550A4F504DE01CE6BCB74A5B9618DBBD366D31EC9037E79533FAEE6BA6423224CC5546EBAF03D17777C025DA549AE0EBDFFF4A9E51583C0D954D9BB9238AC8C4DFAF2A8A64B2B4E203D3CE8D63C6C3EC45E27C6AC7991076BABB5059F7EB919981AF18928201D9F8CC8B92E6F48F78E9084D9F8B622955E26D0E845CA50F5163ADE9807DE9621707B6C68260EDDF3A551FA5869ED17183CB6639ADC400E63D4F60D92CA8E1A5C805ADC537ACFBB76FF527ECAF8334159F88409442DF641593444FEB96A8BB2208377E902B8C46A92D60837188A66A619487BE7AF4431114D4A4F84FDC807A95400B4189B963C0800E6575DB5EAF263E16FD2E2797E4BFD20353A0484613EC6ABAF018DFC3AABCF743208A287A10AE81520D1D2A2E290CB010B29C68A0D3AED211B41FE4B50489ADE08066175726120BA5B4C0800000000056175726101014C4F631E503B273D608797B7B326320788A9FDFC6327C3C79BA7B19E7126B6286DD04838E00BF722B5791C97681FB4390638C00B49CF982B2C83E2E99FC49580010000000D00000000")]
        public void ParaInclusion_CandidateBackedToDto_ShouldBeParsed(string hex)
        {
            var nodeResult = _substrateDecode.DecodeEvent(hex);
            Assert.IsNotNull(nodeResult);

            var eventDto = new EventLightDto()
            {
                Block = new Domain.Contracts.Dto.Block.BlockDto(),
                PalletName = nodeResult.HumanData.ToString(),
                EventName = nodeResult.Children.First().HumanData.ToString(),
                Description = ""//nodeResult.Children.First().Children.First().HumanData,
            };
        }
    }
}
